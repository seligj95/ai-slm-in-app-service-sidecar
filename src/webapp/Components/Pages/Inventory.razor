@page "/inventory"
@layout MainLayout
@using dotnetfashionassistant.Models
@using dotnetfashionassistant.Components.Layout;
@rendermode InteractiveServer

<PageTitle>Fashion Store Inventory</PageTitle>

<div class="container">
    <div class="content">
        <h1 class="page-title">Fashion Store Inventory</h1>

        <div class="table-responsive">
            <table class="table table-striped table-bordered inventory-table">
                <thead class="table-dark">
                    <tr>
                        <th>Product</th>
                        @foreach (var size in InventoryService.GetSizes())
                        {
                            <th>@size</th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in inventory)
                    {
                        <tr>
                            <td class="product-name">@item.ProductName</td>
                            @foreach (var size in InventoryService.GetSizes())
                            {
                                <td class="@GetStockLevelClass(item.SizeInventory[size])">
                                    @item.SizeInventory[size]
                                </td>
                            }
                        </tr>
                    }                </tbody>
            </table>
        </div>
        
        <div class="legend mt-3">
            <h6>Stock Level Legend:</h6>
            <div class="d-flex flex-wrap">
                <div class="legend-item">
                    <span class="legend-color bg-danger"></span> Low Stock (&lt; 6)
                </div>
                <div class="legend-item">
                    <span class="legend-color bg-warning"></span> Medium Stock (6-15)
                </div>
                <div class="legend-item">
                    <span class="legend-color bg-success"></span> Good Stock (> 15)
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Center and top align the container */
    .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        min-height: 100vh;
        padding: 20px;
        text-align: center;
    }

    /* Narrow the heading */
    .page-title {
        font-size: 1.5em;
        margin-bottom: 0.5em;
        width: 100%;
        max-width: 800px;
        text-align: center;
    }

    /* Content styling */
    .content {
        width: 100%;
        max-width: 800px;
        text-align: left;
    }

    .inventory-table {
        margin-top: 20px;
    }

    .product-name {
        font-weight: 500;
        max-width: 300px;
    }

    /* Legend styling */
    .legend {
        margin-top: 20px;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 10px;
        background-color: #f8f9fa;
    }

    .legend-item {
        display: flex;
        align-items: center;
        margin-right: 20px;
        margin-bottom: 5px;
    }

    .legend-color {
        display: inline-block;
        width: 20px;
        height: 20px;
        margin-right: 5px;
        border-radius: 3px;
    }
</style>

@code {    private List<InventoryItem> inventory = null!;

    protected override void OnInitialized()
    {
        inventory = InventoryService.GetInventory();
    }

    private string GetStockLevelClass(int count)
    {
        if (count < 6)
            return "bg-danger text-white";
        if (count <= 15)
            return "bg-warning";
        return "bg-success text-white";
    }
}
